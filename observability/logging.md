# 📜 Kubernetes Logging Guide

This guide provides a complete overview of logging in Kubernetes, including how to collect, view, and aggregate logs effectively using various tools and practices.


### 📦 1. Application Logs
### 🔧 2. Node-Level Logs
### 🌐 3. Cluster-Level Logging
### 🧪 Fluent Bit Example (DaemonSet)
### ♻️ Log Rotation and Retention
### ✅ Best Practices
### 🐞 Troubleshooting


### 📦 1. Application Logs
Application logs are generated by your containers. These logs should be written to stdout and stderr.
🔍 View Logs:
```kubectl logs <pod-name>
kubectl logs <pod-name> -c <container-name>      # For multi-container pods
kubectl logs <pod-name> --previous               # For crashed containers
```

### 🔧 2. Node-Level Logs
These logs come from components running on Kubernetes nodes:
Component	Log Location (systemd-based)

kubelet	journalctl -u kubelet
containerd	journalctl -u containerd
kube-proxy	journalctl -u kube-proxy
Container logs	/var/log/containers/*.log
📌 Tip: Use SSH access to nodes for direct inspection.

### 🌐 3. Cluster-Level Logging
For production, use a centralized logging solution to collect logs from all nodes.
🏗️ Popular Stacks:
Stack	Components	Notes
EFK	Elasticsearch, Fluentd, Kibana	Full-featured open-source stack
Loki	Loki, Promtail, Grafana	Lightweight, Grafana-native
Fluent Bit	Fluent Bit only	Lightweight log forwarder
SaaS	Datadog, Splunk, Logz.io, etc.	Hosted solutions for large clusters
🧪 Fluent Bit Example (DaemonSet)
Deploy Fluent Bit as a DaemonSet to collect logs from all nodes.

```apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: fluent-bit
  namespace: logging
spec:
  selector:
    matchLabels:
      app: fluent-bit
  template:
    metadata:
      labels:
        app: fluent-bit
    spec:
      containers:
      - name: fluent-bit
        image: fluent/fluent-bit:latest
        volumeMounts:
        - name: varlog
          mountPath: /var/log
        - name: containers
          mountPath: /var/lib/docker/containers
      volumes:
      - name: varlog
        hostPath:
          path: /var/log
      - name: containers
        hostPath:
          path: /var/lib/docker/containers
```


## ♻️ Log Rotation and Retention

    Container logs are stored on the node (e.g., /var/log/containers/) and can fill disk space if not rotated.
    Docker JSON Driver Example:
    {
    "log-driver": "json-file",
    "log-opts": {
        "max-size": "10m",
        "max-file": "3"
    }
    }
### Tools:
logrotate on Linux
Configure container runtime (containerd, docker, etc.)
✅ Best Practices
✅ Log to stdout and stderr, not files inside containers
✅ Use structured logging (JSON format)
✅ Include contextual metadata: pod name, namespace, request ID
✅ Use proper log levels: DEBUG, INFO, WARN, ERROR
✅ Implement centralized log aggregation
✅ Secure log access with RBAC and tools like Kibana


## 🐞 Troubleshooting
Task	Command Example
View logs of a pod	kubectl logs my-pod
Follow logs in real time	kubectl logs -f my-pod
Logs from specific container	kubectl logs my-pod -c nginx
Logs from previous crashed pod	kubectl logs my-pod --previous
Check kubelet logs	journalctl -u kubelet
Check containerd logs	journalctl -u containerd
